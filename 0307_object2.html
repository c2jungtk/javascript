<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .csoon {
            background-color: blueviolet;
        }
    </style>
</head>

<body>
<!-- 바디를 잡는 법 (태그) -->
    <div>



    </div>


    <script>
        // 객체를 만들고 출력하기
        // 첫번째 객체 만들기
        var mytodo = [{
                'todo': '디자인',
                'due': '11/20',
                'priority': 1,
                'memo': '사진변경'
            }, {
                'todo': '비행기 표',
                'due': '11/22',
                'priority': 3,
                'memo': ''
            }, {
                'todo': '책 반납',
                'due': '12/1',
                'priority': 2,
                'memo': '다른 책 빌리기'
            }, {
                'todo': '친구 만나기',
                'due': '3/8',
                'priority': 2,
                'memo': '커피 내놔'
            }, {
                'todo': '도서 반납',
                'due': '3/9',
                'priority': 3,
                'memo': '아무도 네 인생을 대신 살아주지 않는다.'
            }                      
            ]
        // 객체를 표로 출력하기
        var mytodotable = "";
        mytodotable += "<tr>";
        mytodotable += "<th>순번</th> <th>Todo</th> <th>Due</th> <th>Priority</th> <th>Memo</th> <th>Daysleft</th>";
        mytodotable += "</tr>";
        mytodotable += "<table>";
        var mylen = mytodo.length;
        for (var i=0; i < mylen; i++) {
            var daysLeftres = daysLeft(i);
            if (mytodo[i]['priority'] === 1 || daysLeftres === '곧' ) {
                mytodotable += "<tr class='csoon'>";
            }else {
                mytodotable += "<tr>";
            }
            mytodotable += "<td>"+(i+1)+"</td>";
            mytodotable += "<td>" + mytodo[i]['todo'] + "</td>";
            mytodotable += "<td>" + mytodo[i]['due'] + "</td>";
            mytodotable += "<td>" + mytodo[i]['priority'] + "</td>";
            mytodotable += "<td>" + mytodo[i]['memo'] + "</td>";
            mytodotable += "<td>" + daysLeft(i) + "</td>";
            mytodotable += "</tr>";
        }
        mytodotable += "</table>";


        // 리스트로 반환 (자료형)
        // 화면에 적용
        // p요소에 정보를 담을 table을 추가한다
        function daysLeft(para1) {
            var curday, curMsec, month, day, dueday, dueMsec, leftdays, idx, duestr;
            // 현재 (페이지를 읽은 시간)의 시간을 구하고
            curday = new Date();
            curMsec = curday.getTime();
            // 목표시간을 구하고
            duestr = mytodo[para1]['due'];
            idx = duestr.indexOf('/')
            month = duestr.slice(0,idx)-1;
            day = duestr.slice(idx+1,duestr.length);
            dueday = new Date(2018,month,day);
            dueMsec = dueday.getTime();
            // 남은 시간을 계산한다.
            leftdays = Math.floor((dueMsec - curMsec)/(1000*60*60*24));
            // 조건이 삼항 연산자는 (조건)? 참:거짓;
            leftdays = (leftdays === 0)?"곧":leftdays;

            // 값을 돌려준다.
            return leftdays;

            
        }
        
        var dispElem = document.createElement('P');
        // var textnode = document.createTextNode(mytodotable);
        // dispElem.appendChild(textnode);
        dispElem.innerHTML = mytodotable
        var bodyElem = document.getElementsByTagName('body')[0];
        bodyElem.appendChild(dispElem);
    as.innerHTML


        // 날짜 객체
    </script>

</body>

</html>